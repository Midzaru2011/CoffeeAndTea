<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <title>–ú–µ–Ω—é –∫–æ—Ñ–µ–π–Ω–∏</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ JavaScript -->
    <script th:src="@{/js/scripts.js}" type="text/javascript"></script>
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />
</head>
<body>
<!-- –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤—ã—Ö–æ–¥ -->
<div th:if="${#authentication != null and #authentication.isAuthenticated()}" class="auth-info">
    <p><strong>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ </strong> <span th:text="${#authentication.name}"></span>.</p>
    <button id="logout-button" class="logout-button">–í—ã–π—Ç–∏</button>
</div>
<div th:if="${#authentication == null or not #authentication.isAuthenticated()}">
    <p>–í—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã.</p>
    <a href="/login" class="login-link">–í–æ–π—Ç–∏</a>
</div>
<div class="gigachat-section">
    <h2 class="gigachat-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—Ñ–µ</h2>
    <span class="icon"></span>
    <p class="gigachat-subtitle">–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ GigaChat</p>

    <div class="coffee-info-form">
        <input type="text" id="coffee_name" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ—Ñ–µ" />
        <button id="get-info-btn">–£–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</button>
    </div>

    <!-- –ë–ª–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
    <div id="coffee-details"></div>
</div>
<div style="text-align: center; margin: 30px 0; padding: 20px; background-color: #f0e6d2; border-radius: 10px;">
    <h2 style="color: #8B4513; margin-bottom: 15px;">‚òï –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–æ—Ñ–µ –ø–æ –ø–æ–≥–æ–¥–µ üå§Ô∏è</h2>
    <p style="margin-bottom: 20px; color: #666;">–ü–æ–∑–≤–æ–ª—å—Ç–µ –Ω–∞–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π –∫–æ—Ñ–µ –¥–ª—è –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞ –∏ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã!</p>
    <a href="/recommendations" style="background-color: #8B4513; color: white; padding: 12px 25px; text-decoration: none; border-radius: 25px; font-weight: bold; transition: background-color 0.3s;" onmouseover="this.style.backgroundColor='#5D2F0A'" onmouseout="this.style.backgroundColor='#8B4513'">
        üå§Ô∏è –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
    </a>
</div>
<h1>–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏</h1>
<!-- –¢–∞–±–ª–∏—Ü–∞ —Å –Ω–∞–ø–∏—Ç–∫–∞–º–∏ -->
<table>
    <thead>
    <tr>
        <th>–ù–∞–ø–∏—Ç–æ–∫</th>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th> <!-- –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è -->
        <th>–¶–µ–Ω–∞</th>
        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="coffee : ${coffees}">
        <td>
            <img th:src="${coffee.imageUrl}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Ç–∫–∞" class="coffee-image">
        </td>
        <td th:text="${coffee.name}"></td>
        <td th:text="${coffee.description}"></td> <!-- –û—Ç–æ–±—Ä–∞–∑–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
        <td>
            <span th:text="${coffee.price}"></span> —Ä—É–±.
        </td>
        <td>
            <form th:action="@{/add}" method="post" style="display:inline;">
                <input type="hidden" name="coffeeName" th:value="${coffee.name}">
                <button type="submit" class="add-button">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
<h2>–¢–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑</h2>
<ul class="order-list">
    <li th:each="entry : ${order.coffeesWithCounts}">
        <span class="coffee-name" th:text="${entry.key.name}"></span>
        <span class="coffee-quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <span th:text="${entry.value}"></span></span>
        <span class="coffee-price" th:text="${entry.key.price} + ' —Ä—É–±.'"></span>
        <form th:action="@{/remove}" method="post" style="display:inline;">
            <input type="hidden" name="coffeeName" th:value="${entry.key.name}">
            <button type="submit" class="remove-button">–£–¥–∞–ª–∏—Ç—å</button>
        </form>
    </li>
</ul>
<p>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: <span th:text="${order.total}"></span> —Ä—É–±.</p>
<form th:action="@{/checkout}" method="post">
    <div th:if="${message}" style="color: green; font-weight: bold;">
        <p th:text="${message}"></p>
    </div>
    <button type="submit">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</form>
<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>